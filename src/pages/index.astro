---
import BaseLayout from '../layouts/BaseLayout.astro';
import Nav from '../components/Nav.astro';
import Footer from '../components/Footer.astro';
import Hero from '../components/Hero.astro';
import TrustStrip from '../components/TrustStrip.astro';
import ServiceCard from '../components/ServiceCard.astro';
import TestimonialCard from '../components/TestimonialCard.astro';
import PricingCard from '../components/PricingCard.astro';
import BarrioTag from '../components/BarrioTag.astro';
import FAQAccordion from '../components/FAQAccordion.astro';
import CTABox from '../components/CTABox.astro';
import VideoEmbed from '../components/VideoEmbed.astro';
import CalendlyEmbed from '../components/CalendlyEmbed.astro';

import serviciosData from '../data/servicios.json';
import barriosData from '../data/barrios.json';

const faqItems = [
  {
    question: "¬øCu√°nto cuesta?",
    answer: "Primera consulta 50‚Ç¨ (incluye plan personalizado). Revisiones 40‚Ç¨ cada 21 d√≠as. Pack 4 sesiones: 140‚Ç¨ (ahorro de 30‚Ç¨)."
  },
  {
    question: "¬øPresencial u online?",
    answer: "Ambas modalidades disponibles. Presencial en Centro M√©dico Arboleda (Boadilla) u online por Google Meet."
  },
  {
    question: "¬øCu√°nto tarda en verse resultados?",
    answer: "En p√©rdida de peso, los primeros cambios se notan en 2-3 semanas. Depende de tu objetivo y situaci√≥n inicial."
  },
  {
    question: "¬øDietas estrictas?",
    answer: "No. Educaci√≥n nutricional y planes personalizados. Sin prohibiciones extremas ni dietas milagro."
  }
];

const testimonials = [
  {
    quote: "Perd√≠ 12 kilos en 4 meses y no he recuperado nada. Aprend√≠ a comer bien sin pasar hambre.",
    author: "Laura M.",
    service: "P√©rdida de peso",
    rating: 5
  },
  {
    quote: "Mar√≠a me cambi√≥ la vida. Con el plan FODMAP reduje la hinchaz√≥n en un 80%. Ahora como sin miedo.",
    author: "Carlos R.",
    service: "Salud digestiva",
    rating: 5
  }
];

---

<BaseLayout
  title="Nutricionista en Boadilla del Monte | Mar√≠a De la Vera ¬∑ MAD01182"
  description="Nutricionista colegiada en Boadilla del Monte. P√©rdida de peso, nutrici√≥n deportiva, salud digestiva y hormonal. Primera consulta 50‚Ç¨. Reserva cita."
>
  <Nav slot="nav" />

  <!-- Hero -->
  <Hero
    badge="üìç Nutricionista en Boadilla del Monte"
    title="Tu nutricionista en Boadilla del Monte"
    titleAccent="Boadilla del Monte"
    subtitle="Planes 100% personalizados. Sin dietas milagro, sin efecto rebote. Primera consulta 50‚Ç¨."
  />

  <!-- V√≠deo presentaci√≥n -->
  <section class="section section--alt" id="video">
    <div class="container">
      <h2 class="text-center" style="margin-bottom: var(--spacing-lg);">Con√≥ceme en 1 minuto</h2>
      <div style="max-width: 900px; margin: 0 auto;">
        <VideoEmbed title="Presentaci√≥n Mar√≠a De la Vera - Nutricionista" />
      </div>
    </div>
  </section>

  <!-- Trust bar -->
  <TrustStrip />

  <!-- Servicios -->
  <section class="section" id="servicios">
    <div class="container">
      <h2 class="text-center" style="margin-bottom: var(--spacing-xl);">¬øEn qu√© puedo ayudarte?</h2>

      <div class="grid grid--3">
        {serviciosData.map(servicio => (
          <ServiceCard
            emoji={servicio.emoji}
            title={servicio.title}
            description={servicio.shortDesc}
            href={`/${servicio.slug}`}
          />
        ))}
      </div>
    </div>
  </section>

  <!-- C√≥mo funciona -->
  <section class="section section--alt" id="como-funciona">
    <div class="container">
      <h2 class="text-center" style="margin-bottom: var(--spacing-xl);">¬øC√≥mo funciona?</h2>

      <div class="grid grid--3">
        <div class="card" style="text-align: center;">
          <div style="font-size: 3rem; margin-bottom: var(--spacing-md);">1Ô∏è‚É£</div>
          <h3>Primera consulta</h3>
          <p style="color: var(--color-text-secondary);">
            Entrevista completa y an√°lisis. <strong>50‚Ç¨</strong>
          </p>
        </div>

        <div class="card" style="text-align: center;">
          <div style="font-size: 3rem; margin-bottom: var(--spacing-md);">2Ô∏è‚É£</div>
          <h3>Tu plan en 24-72h</h3>
          <p style="color: var(--color-text-secondary);">
            Plan personalizado con men√∫s y recetas.
          </p>
        </div>

        <div class="card" style="text-align: center;">
          <div style="font-size: 3rem; margin-bottom: var(--spacing-md);">3Ô∏è‚É£</div>
          <h3>Revisiones</h3>
          <p style="color: var(--color-text-secondary);">
            Cada 21 d√≠as. <strong>40‚Ç¨/revisi√≥n</strong>
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Precios -->
  <section class="section" id="precios">
    <div class="container">
      <h2 class="text-center" style="margin-bottom: var(--spacing-xl);">Precios</h2>

      <div class="grid grid--2" style="max-width: 900px; margin: 0 auto;">
        <PricingCard
          title="Consulta individual"
          price="50‚Ç¨"
          description="Ideal para empezar o si prefieres ir sesi√≥n por sesi√≥n."
          features={[
            "Primera consulta completa (50‚Ç¨)",
            "Plan nutricional personalizado",
            "Material de apoyo y recetas",
            "Revisiones a 40‚Ç¨ cada 21 d√≠as"
          ]}
          ctaText="Reservar primera consulta"
        />

        <PricingCard
          title="Pack 4 sesiones"
          price="140‚Ç¨"
          description="La opci√≥n m√°s elegida: compromiso y ahorro desde el inicio."
          features={[
            "Primera consulta + 3 revisiones",
            "Plan nutricional personalizado",
            "Seguimiento durante 2 meses",
            "Ahorro de 30‚Ç¨ vs pago individual"
          ]}
          highlighted={true}
          savings="30‚Ç¨"
          ctaText="Reservar pack completo"
        />
      </div>
    </div>
  </section>

  <!-- Testimonios -->
  <section class="section section--alt" id="testimonios">
    <div class="container">
      <h2 class="text-center" style="margin-bottom: var(--spacing-xl);">Lo que dicen mis pacientes</h2>

      <div class="grid grid--2" style="max-width: 900px; margin: 0 auto;">
        {testimonials.map(testimonial => (
          <TestimonialCard
            quote={testimonial.quote}
            author={testimonial.author}
            service={testimonial.service}
            rating={testimonial.rating}
          />
        ))}
      </div>
    </div>
  </section>

  <!-- Sobre m√≠ -->
  <section class="section" id="sobre-mi">
    <div class="container">
      <div class="about-grid">
        <div class="about-content">
          <h2 style="margin-bottom: var(--spacing-md);">Hola, soy Mar√≠a De la Vera</h2>
          <p style="margin-bottom: var(--spacing-md);">
            Dietista-Nutricionista colegiada <strong>MAD01182</strong>. Graduada por la <strong>Universidad CEU San Pablo</strong> y con M√°ster en Nutrici√≥n Cl√≠nica por <strong>UDIMA</strong>.
          </p>
          <p style="margin-bottom: var(--spacing-md);">
            M√°s de <strong>700 pacientes atendidos</strong> desde 2023. Ahora en <strong>Boadilla del Monte</strong> (Centro M√©dico Arboleda).
          </p>
          <p>
            Mi enfoque: <strong>educaci√≥n nutricional</strong> y planes 100% personalizados. Sin dietas milagro. Consulta <strong>presencial</strong> u <strong>online</strong>.
          </p>
        </div>

        <div class="about-image">
          <!-- REEMPLAZAR: Subir foto-maria-perfil.webp aqu√≠ -->
          <div class="about-image-placeholder">
            <span style="font-size: 6rem;">üë©‚Äç‚öïÔ∏è</span>
            <p style="color: var(--color-text-secondary); font-style: italic; text-align: center;">
              Foto de Mar√≠a<br>(subir imagen)
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Barrios -->
  <section class="section section--alt" id="barrios">
    <div class="container">
      <h2 class="text-center" style="margin-bottom: var(--spacing-xl);">Zonas de Boadilla</h2>

      <div class="barrios-grid">
        {barriosData.map(barrio => (
          <BarrioTag name={barrio.name} href={`/${barrio.slug}`} />
        ))}
        <BarrioTag name="Consulta online" href="/nutricionista-online" />
      </div>
    </div>
  </section>

  <!-- Reservar cita con Calendly -->
  <section class="section" id="reservar">
    <div class="container">
      <h2 class="text-center" style="margin-bottom: var(--spacing-xl);">Reserva tu cita</h2>

      <div class="tabs">
        <div class="tabs__buttons">
          <button class="tabs__button tabs__button--active" data-tab="presencial">
            üìç Presencial (Boadilla)
          </button>
          <button class="tabs__button" data-tab="online">
            üíª Online (Google Meet)
          </button>
        </div>

        <div class="tabs__content">
          <div class="tabs__panel tabs__panel--active" id="tab-presencial">
            <CalendlyEmbed type="presencial" />
          </div>

          <div class="tabs__panel" id="tab-online">
            <CalendlyEmbed type="online" />
          </div>
        </div>
      </div>

      <p class="text-center" style="margin-top: var(--spacing-lg); color: var(--color-text-secondary);">
        ¬øVienen en pareja? <a href="https://calendly.com/nutricionista-mariadelavera/primera-consulta-parejas" target="_blank" rel="noopener" style="color: var(--color-trust); font-weight: 600;">Reserva consulta para parejas aqu√≠</a>
      </p>
    </div>
  </section>

  <!-- FAQ -->
  <section class="section section--alt" id="faq">
    <div class="container">
      <h2 class="text-center" style="margin-bottom: var(--spacing-xl);">Preguntas frecuentes</h2>

      <div style="max-width: 800px; margin: 0 auto;">
        <FAQAccordion items={faqItems} />
      </div>
    </div>
  </section>

  <!-- CTA Final -->
  <CTABox
    title="¬øListo para empezar?"
    description="Reserva tu primera consulta y da el primer paso hacia tus objetivos de salud."
    ctaText="Reservar cita ahora"
    ctaHref="/reservar"
    variant="trust"
  />

  <Footer slot="footer" />
</BaseLayout>

<style>
  /* About grid */
  .about-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--spacing-xl);
    align-items: center;
  }

  @media (min-width: 1024px) {
    .about-grid {
      grid-template-columns: 1.2fr 0.8fr;
    }
  }

  .about-content p {
    color: var(--color-text-secondary);
    line-height: 1.7;
  }

  .about-image-placeholder {
    width: 100%;
    max-width: 400px;
    aspect-ratio: 1;
    background: linear-gradient(135deg, #f7f3ee 0%, var(--color-accent) 100%);
    border-radius: var(--radius-lg);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    box-shadow: var(--shadow-lg);
    margin: 0 auto;
  }

  /* Barrios grid */
  .barrios-grid {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: var(--spacing-sm);
  }

  /* Tabs */
  .tabs__buttons {
    display: flex;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-lg);
    justify-content: center;
    flex-wrap: wrap;
  }

  .tabs__button {
    padding: 0.875rem 1.75rem;
    background-color: var(--color-white);
    border: 2px solid var(--color-bg-secondary);
    border-radius: var(--radius-full);
    font-family: var(--font-body);
    font-size: 1rem;
    font-weight: 600;
    color: var(--color-text-primary);
    cursor: pointer;
    transition: var(--transition-base);
  }

  .tabs__button:hover {
    border-color: var(--color-trust);
  }

  .tabs__button--active {
    background-color: var(--color-trust);
    color: var(--color-white);
    border-color: var(--color-trust);
  }

  .tabs__panel {
    display: none;
  }

  .tabs__panel--active {
    display: block;
  }
</style>

<script>
  // Tabs functionality
  const tabButtons = document.querySelectorAll('.tabs__button');
  const tabPanels = document.querySelectorAll('.tabs__panel');

  tabButtons.forEach(button => {
    button.addEventListener('click', () => {
      const tabId = button.getAttribute('data-tab');

      // Remove active class from all buttons and panels
      tabButtons.forEach(btn => btn.classList.remove('tabs__button--active'));
      tabPanels.forEach(panel => panel.classList.remove('tabs__panel--active'));

      // Add active class to clicked button and corresponding panel
      button.classList.add('tabs__button--active');
      document.getElementById(`tab-${tabId}`)?.classList.add('tabs__panel--active');
    });
  });
</script>
