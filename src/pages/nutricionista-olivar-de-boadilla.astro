---
import BaseLayout from '../layouts/BaseLayout.astro';
import Nav from '../components/Nav.astro';
import Footer from '../components/Footer.astro';
import Hero from '../components/Hero.astro';
import ServiceCard from '../components/ServiceCard.astro';
import CTABox from '../components/CTABox.astro';
import BarrioTag from '../components/BarrioTag.astro';
import Breadcrumb from '../components/Breadcrumb.astro';
import CalendlySection from '../components/CalendlySection.astro';

import serviciosData from '../data/servicios.json';
import barriosData from '../data/barrios.json';

const barrio = barriosData.find(b => b.slug === 'nutricionista-olivar-de-boadilla')!;
const otrosBarrios = barriosData.filter(b => b.id !== barrio.id).slice(0, 6);
---

<BaseLayout
  title={barrio.metaTitle}
  description={barrio.metaDescription}
  canonical={`/${barrio.slug}`}
>
  <Nav slot="nav" />

  <Hero
    badge={`üìç ${barrio.name}`}
    title={`Nutricionista en ${barrio.name}`}
    titleAccent={barrio.name}
    subtitle={barrio.description}
    showVideo={true}
  />

  <section class="section section--alt">
    <div class="container">
      <div style="max-width: 600px; margin: 0 auto;">
        <div class="card">
          <h2 style="margin-bottom: var(--spacing-md);">Puntos de referencia</h2>
          <ul class="landmarks-list">
            {barrio.landmarks.map(landmark => (
              <li>üìç {landmark}</li>
            ))}
          </ul>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <h2 class="text-center" style="margin-bottom: var(--spacing-md);">Servicios de nutrici√≥n en {barrio.name}</h2>
      <p class="text-center" style="color: var(--color-text-secondary); margin-bottom: var(--spacing-xl); max-width: 700px; margin-left: auto; margin-right: auto;">
        Consulta presencial en el Centro M√©dico Arboleda, ideal para vecinos del Olivar.
      </p>

      <div class="grid grid--3">
        {serviciosData.slice(0, 3).map(servicio => (
          <ServiceCard emoji={servicio.emoji} title={servicio.title} description={servicio.shortDesc} href={`/${servicio.slug}`} />
        ))}
      </div>

      <div class="text-center" style="margin-top: var(--spacing-xl);">
        <a href="/#servicios" class="btn btn--secondary">Ver todos los servicios</a>
      </div>
    </div>
  </section>

  <section class="section section--alt">
    <div class="container">
      <h2 class="text-center" style="margin-bottom: var(--spacing-md);">Otras zonas de Boadilla</h2>
      <div class="barrios-grid">
        {otrosBarrios.map(b => <BarrioTag name={b.name} href={`/${b.slug}`} />)}
      </div>
    </div>
  </section>

  <!-- Calendario de reservas -->
  <CalendlySection />

  <CTABox
    title={`¬øVives en ${barrio.name}?`}
    description="Reserva tu primera consulta en el Centro M√©dico Arboleda."
    ctaText="Reservar cita"
    ctaHref="#reservar"
    variant="trust"
  />

  <Footer slot="footer" />
</BaseLayout>

<style>
  .landmarks-list { list-style: none; padding: 0; display: flex; flex-direction: column; gap: var(--spacing-sm); }
  .landmarks-list li { color: var(--color-text-secondary); font-size: 0.95rem; line-height: 1.6; }
  .barrios-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: var(--spacing-sm); }
</style>
