---
interface Props {
  title?: string;
  vertical?: boolean;
}

const {
  title = "Presentaci\u00f3n Mar\u00eda De la Vera - Nutricionista",
  vertical = false
} = Astro.props;

// Video de Vimeo - formato vertical
const videoId = "1137833163";
const videoHash = "7317f4af36";
const thumbnailUrl = `https://vumbnail.com/${videoId}.jpg`;
---

<div class={`hero-video ${vertical ? 'hero-video--vertical' : ''}`} data-video-id={videoId} data-video-hash={videoHash}>
  <div class="hero-video__poster">
    <img
      src={thumbnailUrl}
      alt={title}
      loading="lazy"
      width="280"
      height="500"
      decoding="async"
    />
    <button class="hero-video__play" aria-label={`Reproducir: ${title}`}>
      <svg width="56" height="56" viewBox="0 0 56 56" fill="none">
        <circle cx="28" cy="28" r="28" fill="rgba(0,0,0,0.55)"/>
        <path d="M22 18l16 10-16 10V18z" fill="white"/>
      </svg>
    </button>
  </div>
  <div class="hero-video__iframe" style="display:none;"></div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const videos = document.querySelectorAll('.hero-video[data-video-id]');
    videos.forEach((container) => {
      const playBtn = container.querySelector('.hero-video__play');
      if (!playBtn) return;
      playBtn.addEventListener('click', () => {
        const id = container.getAttribute('data-video-id');
        const hash = container.getAttribute('data-video-hash');
        const poster = container.querySelector('.hero-video__poster') as HTMLElement;
        const iframeWrap = container.querySelector('.hero-video__iframe') as HTMLElement;
        if (!poster || !iframeWrap || !id) return;
        const iframe = document.createElement('iframe');
        iframe.src = `https://player.vimeo.com/video/${id}?h=${hash}&autoplay=1&title=0&byline=0&portrait=0`;
        iframe.allow = 'autoplay; fullscreen; picture-in-picture';
        iframe.allowFullscreen = true;
        iframe.style.cssText = 'width:100%;height:100%;border:none;';
        iframeWrap.appendChild(iframe);
        poster.style.display = 'none';
        iframeWrap.style.display = 'block';
      });
    });
  });
</script>

<style>
  .hero-video {
    width: 280px;
    height: 500px;
    border-radius: 24px;
    overflow: hidden;
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
    background: #000;
    position: relative;
  }

  .hero-video__poster {
    width: 100%;
    height: 100%;
    position: relative;
    cursor: pointer;
  }

  .hero-video__poster img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .hero-video__play {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
    transition: transform 0.2s;
  }

  .hero-video__play:hover {
    transform: translate(-50%, -50%) scale(1.1);
  }

  .hero-video__iframe {
    width: 100%;
    height: 100%;
  }

  /* Mobile */
  @media (max-width: 900px) {
    .hero-video {
      width: 200px;
      height: 356px;
      border-radius: 18px;
      margin: 0 auto;
    }
  }

  @media (max-width: 420px) {
    .hero-video {
      display: none;
    }
  }
</style>
